<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>밑바닥부터 시작하는 딥러닝 | 지혁&#39;s Blog</title>
  
  

  

  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  
    
<link rel="stylesheet" href="/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <h1 class='title'>지혁's Blog</h1>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="search" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-rss fa-fw'></i>&nbsp;Home
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/projects/"
            
            
            id="projects">
            <i class='fas fa-code-branch fa-fw'></i>&nbsp;Projects
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;About
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" target="_self" href='/' >
        
          지혁's Blog
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                    target="_self"
                  
                  id="home">
									<i class='fas fa-grin fa-fw'></i>&nbsp;Home
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/"
                  
                    rel="nofollow"
                  
                  
                    target="_self"
                  
                  id="categories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;Categories
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/tags/"
                  
                    rel="nofollow"
                  
                  
                    target="_self"
                  
                  id="tags">
									<i class='fas fa-hashtag fa-fw'></i>&nbsp;Tags
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/archives/"
                  
                    rel="nofollow"
                  
                  
                    target="_self"
                  
                  id="archives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;Archives
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="search" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;Home
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/archives/"
                
                  rel="nofollow"
                
                
                id="archives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;Archives
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;Projects
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;Reference
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;About
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  
    <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019/11/03/deeplearning/">
        밑바닥부터 시작하는 딥러닝
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="http://jungjihyuk.github.io" rel="nofollow">
        
          <i class="fas fa-user" aria-hidden="true"></i>
        
        <p>Jihyuk Jung</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-11-03</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/AI/Deep-Learning/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>AI&nbsp;/&nbsp;Deep Learning</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <h1 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. Chapter 2 &quot;Perceptron&quot;</span><br><span class="line">2. Chapter 3 &quot;신경망&quot;</span><br><span class="line">3. Chapter 4 &quot;신경망 학습&quot;</span><br></pre></td></tr></table></figure>
<br>

<p><span style="font-size: 20px; background: rgb(36, 54, 76); color: white; padding: 2px;">Navigation</span> <br><br><a href="#1st"><span style="font-size: 18px; background: rgb(76, 217, 229); color: white; padding: 2px;">Perceptron</span></a> &nbsp;<br><a href="#2nd"><span style="font-size: 18px; background: rgb(30, 219, 173); color: white; padding: 2px;">신경망</span></a> &nbsp;<br><a href="#3rd"><span style="font-size: 18px; background: rgb(226, 71, 0); color: white; padding: 2px;">신경망 학습</span></a> &nbsp;</p>
<hr>

<p><a id="1st"></a></p>
<h1 id="Chapter-2-“Perceptron”"><a href="#Chapter-2-“Perceptron”" class="headerlink" title="Chapter 2 “Perceptron”"></a>Chapter 2 “Perceptron”</h1><br>

<h2 id="AND-Gate-Python으로-구현하기"><a href="#AND-Gate-Python으로-구현하기" class="headerlink" title="AND Gate Python으로 구현하기"></a>AND Gate Python으로 구현하기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 내가 만든</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">and1</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    <span class="keyword">return</span> x1*x2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">and3</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.7</span></span><br><span class="line">    temp = np.sum(x*w) + b</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> <span class="number">1</span>/(<span class="number">1</span> + np.exp(-x)) &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>)(temp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 책 내용 변형</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">and2</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    w1, w2, threshold = <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.7</span></span><br><span class="line">    temp = x1*w1 + x2*w2</span><br><span class="line">    <span class="keyword">if</span> temp &gt; threshold:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">and1(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"><span class="number">138</span> ns ± <span class="number">11.7</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">10000000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">and2(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"><span class="number">413</span> ns ± <span class="number">53</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">and3(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">12.8</span> µs ± <span class="number">389</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">100000</span> loops each)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="OR-Gate-Python으로-구현하기"><a href="#OR-Gate-Python으로-구현하기" class="headerlink" title="OR Gate Python으로 구현하기"></a>OR Gate Python으로 구현하기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 내가 만든  </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or1</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> x1, x2: <span class="number">1</span> <span class="keyword">if</span> x1+x2 &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)(x1, x2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or4</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.1</span></span><br><span class="line">    temp = np.sum(w*x) + b</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> <span class="number">1</span>/(<span class="number">1</span> + np.exp(-x)) &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>)(temp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 책 내용 변형</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or2</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    w1, w2, threshold = <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.2</span></span><br><span class="line">    temp = x1*w1 + x2*w2</span><br><span class="line">    <span class="keyword">if</span> temp &gt; threshold:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or3</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.2</span></span><br><span class="line">    temp = np.sum(w*x) + b</span><br><span class="line">    <span class="keyword">if</span> temp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or1(<span class="number">0</span>,<span class="number">0</span>)      </span><br><span class="line"><span class="number">385</span> ns ± <span class="number">68.5</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or1(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">418</span> ns ± <span class="number">43.6</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or2(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"><span class="number">501</span> ns ± <span class="number">40</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or2(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">379</span> ns ± <span class="number">43.4</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">1000000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or3(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"><span class="number">9.47</span> µs ± <span class="number">583</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">100000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or3(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">9.74</span> µs ± <span class="number">588</span> ns per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">100000</span> loops each)</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">or4(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"><span class="number">13.9</span> µs ± <span class="number">1.57</span> µs per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">10000</span> loops each)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="XOR-Gate-Python으로-구현하기"><a href="#XOR-Gate-Python으로-구현하기" class="headerlink" title="XOR Gate Python으로 구현하기"></a>XOR Gate Python으로 구현하기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">and1</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.7</span></span><br><span class="line">    temp = np.sum(x*w) + b</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> <span class="number">1</span>/(<span class="number">1</span> + np.exp(-x)) &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>)(temp)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or1</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.1</span></span><br><span class="line">    temp = np.sum(w*x) + b</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> <span class="number">1</span>/(<span class="number">1</span> + np.exp(-x)) &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>)(temp)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nand</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">-0.5</span>, <span class="number">-0.5</span>])</span><br><span class="line">    b = <span class="number">0.7</span></span><br><span class="line">    temp = np.sum(x*w) + b</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> <span class="number">1</span>/(<span class="number">1</span> + np.exp(-x)) &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span>)(temp)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(x1:int, x2:int)</span>-&gt;int:</span></span><br><span class="line">    s1 = nand(x1,x2)</span><br><span class="line">    s2 = or1(x1,x2)</span><br><span class="line">    result = and1(s1,s2)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">%%timeit</span><br><span class="line">xor(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">40.7</span> µs ± <span class="number">4.55</span> µs per loop (mean ± std. dev. of <span class="number">7</span> runs, <span class="number">10000</span> loops each)</span><br></pre></td></tr></table></figure>
<br>

<hr>

<p><a id="2nd"></a></p>
<h1 id="Chapter-3-“신경망”"><a href="#Chapter-3-“신경망”" class="headerlink" title="Chapter 3 “신경망”"></a>Chapter 3 “신경망”</h1><br>

<h2 id="활성화-함수"><a href="#활성화-함수" class="headerlink" title="활성화 함수"></a>활성화 함수</h2><blockquote>
<p>신호의 총 합을 출력 신호로 변환하는 함수</p>
</blockquote>
<br>

<h3 id="단층-퍼셉트론에서-사용하는-Step-Function"><a href="#단층-퍼셉트론에서-사용하는-Step-Function" class="headerlink" title="단층 퍼셉트론에서 사용하는 Step Function"></a>단층 퍼셉트론에서 사용하는 Step Function</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step</span><span class="params">(x)</span>:</span></span><br><span class="line">    y = x &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> y.astype(np.int)</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line">y = step(x)</span><br><span class="line">plt.plot(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/33630505/68103497-6b8ac580-ff1a-11e9-9b10-7b83912d064f.JPG" alt="step"><br><br></p>
<h3 id="Sigmoid-Function"><a href="#Sigmoid-Function" class="headerlink" title="Sigmoid Function"></a>Sigmoid Function</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line">y = sigmoid(x)</span><br><span class="line">plt.plot(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/33630505/68103521-79d8e180-ff1a-11e9-8aa6-cd8c23ec31c8.JPG" alt="sigmoid"></p>
<br>

<h3 id="Relu-Function"><a href="#Relu-Function" class="headerlink" title="Relu Function"></a>Relu Function</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">relu</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.maximum(<span class="number">0</span>, x)</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line">y = relu(x)</span><br><span class="line">plt.plot(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/33630505/68103558-adb40700-ff1a-11e9-91ba-3e00f6e486d2.JPG" alt="relu"></p>
<br>

<h3 id="Hyperbolic-Tangent-Function"><a href="#Hyperbolic-Tangent-Function" class="headerlink" title="Hyperbolic Tangent Function"></a>Hyperbolic Tangent Function</h3><blockquote>
<p>sigmoid보다 output 값의 범위가 넓어 vanishing gradient 문제가 발생할 가능성이 있는 모델에서 사용한다.<br><br>하지만 여전히 층이 많이 깊어지면 vanishing gradient 문제를 피할 수는 없다.<br><br></p>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/33630505/70371772-c8630c80-191a-11ea-8ec7-8302070c9654.JPG" alt="tanh"><br><img src="https://user-images.githubusercontent.com/33630505/70371778-d153de00-191a-11ea-8aed-cc8b1ef1e4ea.JPG" alt="tanh func"></p>
<p><a href="http://taewan.kim/post/tanh_diff/" target="_blank" rel="noopener">그림 출처</a><br><br></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tanh</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>*sigmoid(<span class="number">2</span>*x) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">-10</span>, <span class="number">10</span>, <span class="number">0.1</span>)</span><br><span class="line">y = tanh(x)</span><br><span class="line">plt.plot(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/33630505/70371764-a9fd1100-191a-11ea-9f8e-ea7d37267f19.JPG" alt="tanh plot"></p>
<br>


<h2 id="선형-VS-비선형"><a href="#선형-VS-비선형" class="headerlink" title="선형 VS 비선형"></a>선형 VS 비선형</h2><blockquote>
<p>중첩의 원리가 적용되면 선형! 적용되지 않으면 비선형!</p>
</blockquote>
<br>

<h3 id="입력값-각각을-함수에-대입한-결과의-합과"><a href="#입력값-각각을-함수에-대입한-결과의-합과" class="headerlink" title="입력값 각각을 함수에 대입한 결과의 합과"></a>입력값 각각을 함수에 대입한 결과의 합과</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">y &#x3D; ax1 + bx2 일때</span><br><span class="line"></span><br><span class="line">if x1, x2 &#x3D;&gt; 1, 2</span><br><span class="line">y1 &#x3D; a + 2b</span><br><span class="line"></span><br><span class="line">if x1, x2 &#x3D;&gt; 5, 10</span><br><span class="line">y2 &#x3D; 5a + 10b</span><br><span class="line"></span><br><span class="line">y &#x3D; y1 + y2</span><br><span class="line">  &#x3D; 6a + 12b</span><br></pre></td></tr></table></figure>
<br>

<h3 id="입력값의-합을-함수에-대입한-결과가-서로-같다면"><a href="#입력값의-합을-함수에-대입한-결과가-서로-같다면" class="headerlink" title="입력값의 합을 함수에 대입한 결과가 서로 같다면"></a>입력값의 합을 함수에 대입한 결과가 서로 같다면</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y &#x3D; ax1  + bx2 일때</span><br><span class="line"></span><br><span class="line">if x1, x2 &#x3D;&gt; (1+5), (2+10)</span><br><span class="line">y &#x3D; 6a + 12b</span><br></pre></td></tr></table></figure>
<br>

<p><span style="color: #fe8559; font-size: 30px">바로! 중첩의 원리가 적용되는 것!</span><br><br><br></p>
<h2 id="신경망에서는-활성화함수로-비선형-함수를-사용하는-이유는"><a href="#신경망에서는-활성화함수로-비선형-함수를-사용하는-이유는" class="headerlink" title="신경망에서는 활성화함수로 비선형 함수를 사용하는 이유는?"></a>신경망에서는 활성화함수로 비선형 함수를 사용하는 이유는?</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">활성화 함수를 f(x) &#x3D; ax 라고 했을 때</span><br><span class="line"></span><br><span class="line">Layer가 3개인 다층 신경망을 식으로 나타내면</span><br><span class="line">y &#x3D; f(f(f(x)))가 됩니다</span><br><span class="line"></span><br><span class="line">그런데 이는 y &#x3D; a*a*a*x와 같고 하나의 선형 함수로 표현할 수 있기 때문에</span><br><span class="line">층을 아무리 깊게 해도 아무 의미가 없게 됩니다.</span><br></pre></td></tr></table></figure>
<br>

<h2 id="행렬-곱연산-VS-dot-VS-matmul"><a href="#행렬-곱연산-VS-dot-VS-matmul" class="headerlink" title="행렬 곱연산 VS dot VS matmul"></a>행렬 곱연산 VS dot VS matmul</h2><br>
**행렬 곱연산(Element wise, 일반적인 행렬 곱셈과 다름)**

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">n = np.array([<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">m = np.array([[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]]])</span><br><span class="line"></span><br><span class="line">n*m</span><br><span class="line">: array([[[<span class="number">1</span>, <span class="number">4</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">8</span>]]])</span><br><span class="line"></span><br><span class="line">m*n</span><br><span class="line">: array([list([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]), list([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])],</span><br><span class="line">      dtype=object)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = np.array([<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">m = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line"></span><br><span class="line">n*m</span><br><span class="line">: array([list([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]), list([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])],</span><br><span class="line">      dtype=object)</span><br><span class="line"></span><br><span class="line">m*n</span><br><span class="line">: array([list([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]), list([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])],</span><br><span class="line">      dtype=object)</span><br><span class="line"></span><br><span class="line">n = np.array([<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">m = np.array([[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]]])</span><br><span class="line"></span><br><span class="line">n*m</span><br><span class="line">: ValueError: operands could <span class="keyword">not</span> be broadcast together <span class="keyword">with</span> shapes (<span class="number">2</span>,) (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<br>

<p><strong>dot(Element wise의 합, 내적)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">g = np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line">h = np.array([<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">np.dot(g,h)</span><br><span class="line">: array([<span class="number">8</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">i = np.array([[<span class="number">1</span>],[<span class="number">2</span>],[<span class="number">3</span>]])</span><br><span class="line">j = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).reshape(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">np.dot(i,j)</span><br><span class="line">: array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3차원부터 matmul과 차이난다</span></span><br><span class="line">A = np.arange(<span class="number">24</span>).reshape(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">B = np.arange(<span class="number">24</span>).reshape(<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">np.dot(A,B)</span><br><span class="line">: array([[[[  <span class="number">42</span>,   <span class="number">48</span>,   <span class="number">54</span>],</span><br><span class="line">         [ <span class="number">114</span>,  <span class="number">120</span>,  <span class="number">126</span>]],</span><br><span class="line"></span><br><span class="line">        [[ <span class="number">114</span>,  <span class="number">136</span>,  <span class="number">158</span>],</span><br><span class="line">         [ <span class="number">378</span>,  <span class="number">400</span>,  <span class="number">422</span>]],</span><br><span class="line"></span><br><span class="line">        [[ <span class="number">186</span>,  <span class="number">224</span>,  <span class="number">262</span>],</span><br><span class="line">         [ <span class="number">642</span>,  <span class="number">680</span>,  <span class="number">718</span>]]],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       [[[ <span class="number">258</span>,  <span class="number">312</span>,  <span class="number">366</span>],</span><br><span class="line">         [ <span class="number">906</span>,  <span class="number">960</span>, <span class="number">1014</span>]],</span><br><span class="line"></span><br><span class="line">        [[ <span class="number">330</span>,  <span class="number">400</span>,  <span class="number">470</span>],</span><br><span class="line">         [<span class="number">1170</span>, <span class="number">1240</span>, <span class="number">1310</span>]],</span><br><span class="line"></span><br><span class="line">        [[ <span class="number">402</span>,  <span class="number">488</span>,  <span class="number">574</span>],</span><br><span class="line">         [<span class="number">1434</span>, <span class="number">1520</span>, <span class="number">1606</span>]]]])</span><br></pre></td></tr></table></figure>
<br>

<p><strong>matmul(@, 행렬 곱셈(matrix multiplication))</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">g = np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line">h = np.array([<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">np.matmul(g,h)</span><br><span class="line">: array([<span class="number">8</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">i = np.array([[<span class="number">1</span>],[<span class="number">2</span>],[<span class="number">3</span>]])</span><br><span class="line">j = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).reshape(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">np.matmul(i,j)</span><br><span class="line">: array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3차원부터 dot과 차이가 난다</span></span><br><span class="line">A = np.arange(<span class="number">24</span>).reshape(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">B = np.arange(<span class="number">24</span>).reshape(<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">np.matmul(A,B)</span><br><span class="line">: array([[[  <span class="number">42</span>,   <span class="number">48</span>,   <span class="number">54</span>],</span><br><span class="line">        [ <span class="number">114</span>,  <span class="number">136</span>,  <span class="number">158</span>],</span><br><span class="line">        [ <span class="number">186</span>,  <span class="number">224</span>,  <span class="number">262</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">906</span>,  <span class="number">960</span>, <span class="number">1014</span>],</span><br><span class="line">        [<span class="number">1170</span>, <span class="number">1240</span>, <span class="number">1310</span>],</span><br><span class="line">        [<span class="number">1434</span>, <span class="number">1520</span>, <span class="number">1606</span>]]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g @ h</span><br><span class="line">: array([<span class="number">8</span>,<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">i @ j</span><br><span class="line">: array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">A @ B</span><br><span class="line">: array([[[  <span class="number">42</span>,   <span class="number">48</span>,   <span class="number">54</span>],</span><br><span class="line">        [ <span class="number">114</span>,  <span class="number">136</span>,  <span class="number">158</span>],</span><br><span class="line">        [ <span class="number">186</span>,  <span class="number">224</span>,  <span class="number">262</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">906</span>,  <span class="number">960</span>, <span class="number">1014</span>],</span><br><span class="line">        [<span class="number">1170</span>, <span class="number">1240</span>, <span class="number">1310</span>],</span><br><span class="line">        [<span class="number">1434</span>, <span class="number">1520</span>, <span class="number">1606</span>]]])</span><br></pre></td></tr></table></figure>
<br>

<p><strong>dot과 matmul</strong> dot은 내적을, matmul은 행렬의 곱을 의미하는데 3차원, 3차원 연산부터 값이 서로 상의 하게 나온다. 내적의 의미는 서로 다른 두 벡터의 방향성을 알 수 있는 연산값이지만 행렬의 곱의 의미는 무엇일까..? 왜 3차원 부터 다른것일까? 아는 사람은 메일 주세요 ㅠ<br>{: .notice}</p>
<br>

<h2 id="내적-inner-product"><a href="#내적-inner-product" class="headerlink" title="내적(inner product)"></a>내적(inner product)</h2><blockquote>
<p>방향이 있는 서로 다른 두 벡터가 있을 때 <br><br>한 벡터를 기준으로 같은 방향이 되도록 다른 한 벡터를 정사영시켜 <br><br>기준 벡터의 크기와 정사영시켜 생긴 벡터의 크기의 곱이다. <br><br>즉, 한쪽 방향으로의 크기의 곱!<br><br><br><img src="https://user-images.githubusercontent.com/33630505/68277234-1d102f00-00b2-11ea-8704-d603090c1c6c.JPG" alt="innerproduct"><br><img src="https://user-images.githubusercontent.com/33630505/68277266-2b5e4b00-00b2-11ea-9b1f-3b5ac13758e5.JPG" alt="innerproduct2"></p>
</blockquote>
<p><span style="color: #fe8559; font-size: 30px">내적을 구하면 두 벡터의 방향이 얼마나 일치하는지 알 수 있다!</span><br></p>
<br>

<h2 id="다층-신경망-구현하기-3층-신경망-또는-2층-신경망"><a href="#다층-신경망-구현하기-3층-신경망-또는-2층-신경망" class="headerlink" title="다층 신경망 구현하기(3층 신경망 또는 2층 신경망)"></a>다층 신경망 구현하기(3층 신경망 또는 2층 신경망)</h2><p><img src="https://user-images.githubusercontent.com/33630505/68211627-43cf5680-001b-11ea-80fe-1b7d59955ca9.JPG" alt="threelayer"><br><br></p>
<h3 id="version-1"><a href="#version-1" class="headerlink" title="version 1"></a>version 1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identity_function</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">X = np.array([<span class="number">1.0</span>, <span class="number">0.5</span>])</span><br><span class="line">W1 = np.array([[<span class="number">0.1</span>, <span class="number">0.3</span>, <span class="number">0.5</span>], [<span class="number">0.2</span>, <span class="number">0.4</span>, <span class="number">0.6</span>]])</span><br><span class="line">B1 = np.array([<span class="number">0.1</span>,<span class="number">0.2</span>,<span class="number">0.3</span>])</span><br><span class="line"></span><br><span class="line">L1 = np.dot(X, W1) + B1</span><br><span class="line">Z1 = sigmoid(L1)</span><br><span class="line"></span><br><span class="line">W2 = np.array([[<span class="number">0.1</span>, <span class="number">0.4</span>], [<span class="number">0.2</span>, <span class="number">0.5</span>], [<span class="number">0.3</span>, <span class="number">0.6</span>]])</span><br><span class="line">B2 = np.array([<span class="number">0.1</span>, <span class="number">0.2</span>])</span><br><span class="line"></span><br><span class="line">L2 = np.dot(Z1, W2) + B2</span><br><span class="line">Z2 = sigmoid(L2)</span><br><span class="line"></span><br><span class="line">W3 = np.array([[<span class="number">0.1</span>, <span class="number">0.3</span>], [<span class="number">0.2</span>, <span class="number">0.4</span>]])</span><br><span class="line">B3 = np.array([<span class="number">0.1</span>, <span class="number">0.2</span>])</span><br><span class="line"></span><br><span class="line">A3 = np.dot(Z2, W3) + B3</span><br><span class="line">Y = identity_function(A3)</span><br></pre></td></tr></table></figure>
<br>

<h3 id="version-2"><a href="#version-2" class="headerlink" title="version 2"></a>version 2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">identity_function</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_network</span><span class="params">()</span>:</span></span><br><span class="line">    network = &#123; &#125;</span><br><span class="line">    network[<span class="string">'W1'</span>] = np.random.random((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">    network[<span class="string">'b1'</span>] = np.random.random((<span class="number">1</span>, <span class="number">3</span>))</span><br><span class="line">    network[<span class="string">'W2'</span>] = np.random.random((<span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line">    network[<span class="string">'b2'</span>] = np.random.random((<span class="number">2</span>))</span><br><span class="line">    network[<span class="string">'W3'</span>] = np.random.random((<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line">    network[<span class="string">'b3'</span>] = np.random.random((<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> network</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(network, X)</span>:</span></span><br><span class="line">    W1, W2, W3 = network[<span class="string">'W1'</span>], network[<span class="string">'W2'</span>], network[<span class="string">'W3'</span>]</span><br><span class="line">    b1, b2, b3 = network[<span class="string">'b1'</span>], network[<span class="string">'b2'</span>], network[<span class="string">'b3'</span>]</span><br><span class="line"></span><br><span class="line">    L1 = np.dot(X, W1) + b1  <span class="comment"># hidden layer</span></span><br><span class="line">    z1 = sigmoid(L1)</span><br><span class="line"></span><br><span class="line">    L2 = np.dot(L1, W2) + b2 <span class="comment"># hidden layer</span></span><br><span class="line">    z2 = sigmoid(L2)</span><br><span class="line"></span><br><span class="line">    L3 = np.dot(L2, W3) + b3 <span class="comment"># output layer</span></span><br><span class="line">    y = identity_function(L3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">network = init_network()</span><br><span class="line">x = np.array([<span class="number">0.1</span>, <span class="number">0.5</span>])</span><br><span class="line">y = forward(network, x)</span><br><span class="line">print(y)</span><br></pre></td></tr></table></figure>
<br>

<h2 id="출력층-설계하기"><a href="#출력층-설계하기" class="headerlink" title="출력층 설계하기"></a>출력층 설계하기</h2><blockquote>
<p>우선 학습의 결과값으로 유한개의 결과가 나오는가 무한개의 결과가 나오는가 판별해야 합니다 <br><br>유한개의 결과가 나온다면 분류 문제 (몇개로 분류되는지도 생각해봐야 함) <br><br>무한개의 결과가 나온다면 회귀 문제 <br></p>
</blockquote>
<p><span style="color: #fe8559; font-size: 30px">결과값을 달리 해야 하기 때문에 출력층에서 사용하는 활성화 함수도 분류 문제인지, 회귀 문제인지에 따라 달라져야 합니다.</span></p>
<br>

<h2 id="기계학습은-학습과-추론-두-단계를-거친다-backward-propagation-amp-forward-propagation"><a href="#기계학습은-학습과-추론-두-단계를-거친다-backward-propagation-amp-forward-propagation" class="headerlink" title="기계학습은 학습과 추론 두 단계를 거친다(backward propagation &amp; forward propagation)"></a>기계학습은 학습과 추론 두 단계를 거친다(backward propagation &amp; forward propagation)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">추론 &#x3D;&gt; 지금의 사고방식(가설함수, 모델)로 예측하는 것</span><br><span class="line">학습 &#x3D;&gt; 예측한 값과 현실의 답(실제값)의 차이를 줄여나가면서</span><br><span class="line">        기존의 사고방식(가설함수의 가중치 및 하이퍼파라미터)을 업데이트</span><br><span class="line"></span><br><span class="line">문제를 해결할 때</span><br><span class="line">사람은 어떤 현상을 보고 패턴을 찾고, 문제에 대한 질문을 생각하고, 답을 찾으며 경험과 직관으로 답을 찾는 반면</span><br><span class="line">기계는 어떤 현상을 인식하기 위해 데이터를 입력 받고, 패턴을 찾기 위해 데이터에서 중요한 데이터를 찾는 과정인</span><br><span class="line">특징을 추출하고 그 특징의 패턴을 찾아 모델을 만듭니다.</span><br><span class="line"></span><br><span class="line">그런데 어떠한 데이터를 벡터로 변환해야 할때</span><br><span class="line">변환을 위해 사용되는 특징은 여전히 사람이 설계해야 합니다.</span><br><span class="line"></span><br><span class="line">따라서 문제에 따라서 사람이 적절한 특징을 생각해내야 합니다.</span><br><span class="line">&#x3D;&gt; 문제를 해결하려는 도메인의 지식이 중요한 이유!</span><br></pre></td></tr></table></figure>
<br>

<h2 id="사람-VS-기계학습-VS-딥러닝"><a href="#사람-VS-기계학습-VS-딥러닝" class="headerlink" title="사람 VS 기계학습 VS 딥러닝"></a>사람 VS 기계학습 VS 딥러닝</h2><blockquote>
<p>딥러닝은 기계학습의 일종이지만 학습을 하는데 있어서 조금 차이를 보입니다.</p>
</blockquote>
<br>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ex) 숫자 5를 학습하는 법</span><br><span class="line"></span><br><span class="line">사람 &#x3D;&gt; 경험, 직관, 신념, 사고방식 등... &#x3D;&gt; 숫자 5구나!?</span><br><span class="line">기계학습 &#x3D;&gt; 사람이 생각한 특징(전처리 등..) &#x3D;&gt; SVM, KNN 등 알고리즘 사용 &#x3D;&gt; 숫자 5구나!?</span><br><span class="line">딥러닝 &#x3D;&gt; 기계가 데이터를 통해 특징 추출까지 직접 함 &#x3D;&gt; 숫자 5구나!?</span><br></pre></td></tr></table></figure>
<br>

<h3 id="분류"><a href="#분류" class="headerlink" title="분류"></a>분류</h3><blockquote>
<p>이중 분류라면 step function이나 sigmoid 다중 분류라면 softmax (step, sigmoid, softmax이외에 다른 함수가 될 수도 있다)<br><br>ex) 0 ~ 9사이의 숫자중 어느 하나를 분류해야하는 문제가 있다고 한다면 출력층의 노드의 수는 10개가 되고 <br><br>2개 이상의 분류이기 때문에 softmax같은 활성화 함수를 활용해 10개의 출력을 하되 마지막에는 가장 확률이 높은 값 하나만을 출력하면 된다</p>
</blockquote>
<br>
**step, sigmoid는 많이 다뤘으므로 softmax를 알아보자**
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax</span><span class="params">(x)</span>:</span></span><br><span class="line">    op = np.max(x)  <span class="comment"># 오버플로우가 발생 방지</span></span><br><span class="line">    x = x - op</span><br><span class="line">    exp = [np.exp(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">    sum_exps = sum(exp)</span><br><span class="line">    <span class="keyword">return</span> [j/sum_exps <span class="keyword">for</span> j <span class="keyword">in</span> exp]</span><br></pre></td></tr></table></figure>

<p><strong>softmax 계산시 오퍼플로우 문제</strong> softmax에 709이상의 입력값을 대입하면 오버플로우 현상이 발생한다. 따라서 오버플로우를 방지하기 위해서 입력값중 가장 큰 값을 뽑아 대입하는 값에 각각을 빼주고 계산하게 되면 각각의 값에 전부 같은 값을 빼주었기 때문에 softmax의 결과는 달라지지 않고 출력됨을 확인할 수 있다. softmax는 발생확률 값을 리턴하기 때문에 출력값의 총 합이 1이되기만 하면 된다.<br>{: .notice}</p>
<br>

<h3 id="MNIST-데이터-셋으로-추론-처리-구현하기-분류"><a href="#MNIST-데이터-셋으로-추론-처리-구현하기-분류" class="headerlink" title="MNIST 데이터 셋으로 추론 처리 구현하기(분류)"></a>MNIST 데이터 셋으로 추론 처리 구현하기(분류)</h3><blockquote>
<p>test data로 이미 학습된 모델(pickle) 정확도 확인하기 (test data의 예측값과 test data의 실제값 비교)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys, os</span><br><span class="line">sys.path.append(os.pardir) <span class="comment"># 부모 디렉터리의 파일을 가져올 수 있도록 설정</span></span><br><span class="line"><span class="keyword">from</span> dataset.mnist <span class="keyword">import</span> load_mnist</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax</span><span class="params">(x)</span>:</span></span><br><span class="line">    op = np.max(x)  </span><br><span class="line">    x = x - op</span><br><span class="line">    exp = [np.exp(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">    sum_exps = sum(exp)</span><br><span class="line">    <span class="keyword">return</span> [j/sum_exps <span class="keyword">for</span> j <span class="keyword">in</span> exp]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># flatten =&gt; 1차원 or 3차원 / normalize =&gt; 0 ~ 1 사이 정규화 할지</span></span><br><span class="line">    (x_train, y_train), (x_test, y_test) = load_mnist(normalize=<span class="literal">True</span>, flatten=<span class="literal">True</span>, one_hot_label=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">return</span> x_test, y_test</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_network</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"sample_weight.pkl"</span>, <span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        network = pickle.load(f)</span><br><span class="line">    <span class="keyword">return</span> network</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(network, x)</span>:</span></span><br><span class="line">    W1, W2, W3 = network[<span class="string">'W1'</span>], network[<span class="string">'W2'</span>], network[<span class="string">'W3'</span>]</span><br><span class="line">    b1, b2, b3 = network[<span class="string">'b1'</span>], network[<span class="string">'b2'</span>], network[<span class="string">'b3'</span>]</span><br><span class="line"></span><br><span class="line">    L1 = np.dot(x, W1) + b1  </span><br><span class="line">    z1 = sigmoid(L1)</span><br><span class="line"></span><br><span class="line">    L2 = np.dot(L1, W2) + b2</span><br><span class="line">    z2 = sigmoid(L2)</span><br><span class="line"></span><br><span class="line">    L3 = np.dot(L2, W3) + b3</span><br><span class="line">    y = softmax(L3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">x, y = get_data()</span><br><span class="line">network = init_network()</span><br><span class="line"></span><br><span class="line">accuracy_cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    t = predict(network, x[i])</span><br><span class="line">    p = np.argmax(t)</span><br><span class="line">    <span class="keyword">if</span> (p == y[i]):</span><br><span class="line">        accuracy_cnt += <span class="number">1</span></span><br><span class="line">print(<span class="string">"Accuracy: "</span> + str(float(accuracy_cnt) / len(x)))</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/oreilly-japan/deep-learning-from-scratch" target="_blank" rel="noopener">MNIST 다운로드</a></p>
<br>

<h3 id="회귀"><a href="#회귀" class="headerlink" title="회귀"></a>회귀</h3><h3 id="배치-Batch"><a href="#배치-Batch" class="headerlink" title="배치 (Batch)"></a>배치 (Batch)</h3><blockquote>
<p>하나로 묶은 입력 데이터를 배치(Batch)라고 합니다. <br><br><br></p>
</blockquote>
<p><strong>MNIST데이터는 숫자 이미지 데이터로 이미지 크기가 28 X 28 =&gt; 784라고 했을 때</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">이미지 데이터 1장일 때</span><br><span class="line">        Input       W1        W2         W3      Output</span><br><span class="line">형상   1 X 784  784 X 50   50 X 100   100 X 10   1 X 10</span><br><span class="line"></span><br><span class="line">이미지 데이터 100장일 때</span><br><span class="line">        Input       W1        W2        W3      Output</span><br><span class="line">형상  100 X 784  784 X 50  50 X 100  100 X 10   100 X 10</span><br></pre></td></tr></table></figure>
<br>

<p><strong>배치 처리의 장점</strong> 1. numpy가 벡터연산을 효율적으로 처리하기 때문에 한번에 많은 데이터를 입력하더라도 빠른 시간에 처리할 수 있다. 2.<br>신경망에서 데이터 전송이 병목으로 작용하는 경우가 자주 있는데, 배치 처리를 함으로써 버스에 주는 부하를 줄일 수 있다.<br>{: .notice}<br><br></p>
<p><strong>배치 처리 구현 (위 MNIST 예제와 동일)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x, y = get_data()</span><br><span class="line">network = init_network()</span><br><span class="line"></span><br><span class="line">batch_size = <span class="number">100</span></span><br><span class="line">accuracy_cnt = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(x), batch_size):</span><br><span class="line">    x_batch = x[i:i+batch_size]</span><br><span class="line">    y_batch = predict(network, x_batch)</span><br><span class="line">    p = np.argmax(y_batch, axis = <span class="number">1</span>) <span class="comment"># axis = 1하는 이유는?</span></span><br><span class="line">    accuracy_cnt += np.sum(p == y[i:i+batch_size])</span><br><span class="line">print(<span class="string">"Accuracy: "</span> + str(float(accuracy_cnt) / len(x)))</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Batch-VS-Mini-Batch-VS-Stochastic-Gradient-Descent"><a href="#Batch-VS-Mini-Batch-VS-Stochastic-Gradient-Descent" class="headerlink" title="Batch VS Mini Batch VS Stochastic Gradient Descent"></a>Batch VS Mini Batch VS Stochastic Gradient Descent</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Batch는 여러 데이터를 한 묶음으로 하여 1 Iteration에 사용되는 data set의 모음</span><br><span class="line">Mini Batch는 전체 데이터에서 특정 Batch Size로 나누어 학습시키는 방법</span><br><span class="line"> - Batch보다 빠르고 SGD보다는 낮은 오차율을 갖는다</span><br><span class="line">Stochastic Gradient Descent는 데이터를 한 개씩 뽑아서 처리하고 모든 데이터에 반복하는 방법이다.</span><br></pre></td></tr></table></figure>
<br>

<p><a id="3rd"></a></p>
<h1 id="Chapter-4-“신경망-학습”"><a href="#Chapter-4-“신경망-학습”" class="headerlink" title="Chapter 4 “신경망 학습”"></a>Chapter 4 “신경망 학습”</h1><br>
## 학습하기

<h3 id="Lose-Function-Cost-Function"><a href="#Lose-Function-Cost-Function" class="headerlink" title="Lose Function(Cost Function)"></a>Lose Function(Cost Function)</h3><blockquote>
<p>신경망 학습에서는 현재 상태를 하나의 지표로 표현하고 <br><br>그 지표를 가장 좋게 만들어주는 가중치 매개 변수의 값을 탐색해나갑니다. <br><br>이때 현재 상태와 다음 상태를 비교하여 최적의 상태를 만들기 위한 수단으로 손실 함수를 사용하게 됩니다.<br><br></p>
</blockquote>
<br>

<h3 id="Mean-Squared-Error-평균-제곱-오차"><a href="#Mean-Squared-Error-평균-제곱-오차" class="headerlink" title="Mean Squared Error(평균 제곱 오차)"></a>Mean Squared Error(평균 제곱 오차)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mse</span><span class="params">(y, t)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5</span> * np.sum((y-t) **<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<br>

<h3 id="Cross-Entropy-Error-교차-엔트로피-오차"><a href="#Cross-Entropy-Error-교차-엔트로피-오차" class="headerlink" title="Cross Entropy Error(교차 엔트로피 오차)"></a>Cross Entropy Error(교차 엔트로피 오차)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cee</span><span class="params">(y, t)</span>:</span></span><br><span class="line">    delta = <span class="number">1e-7</span></span><br><span class="line">    <span class="keyword">return</span> -np.sum(t*np.log(y + delta))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cee</span><span class="params">(y, t)</span>:</span></span><br><span class="line">    delta = <span class="number">1e-7</span></span><br><span class="line">    <span class="keyword">return</span> -np.sum(t*np.log(y + delta) - (<span class="number">1</span>-t)*np.log(<span class="number">1</span>-y + delta))</span><br><span class="line"></span><br><span class="line"><span class="comment"># delta를 더하는 이유는 예측값이 0일 때 연산 결과가 -inf로 나오는 것을 방지하기위해 아주 작은 값을 더했습니다.</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="해석적-미분-VS-수치-미분"><a href="#해석적-미분-VS-수치-미분" class="headerlink" title="해석적 미분 VS 수치 미분"></a>해석적 미분 VS 수치 미분</h2><h3 id="해석적-미분"><a href="#해석적-미분" class="headerlink" title="해석적 미분"></a>해석적 미분</h3><blockquote>
<p>해석적으로 미분 <br><br>오차를 포함하지 않는 진정한 미분 값을 구할 수 있다</p>
</blockquote>
<p><strong>1. 전미분</strong><br><img src="https://user-images.githubusercontent.com/33630505/68744609-57d91080-0638-11ea-9183-15c19533d610.JPG" alt="전미분"></p>
<br>

<p><strong>2. 편미분</strong><br><img src="https://user-images.githubusercontent.com/33630505/68744724-9969bb80-0638-11ea-8d64-0f900004bb52.JPG" alt="편미분"></p>
<br>

<h3 id="수치-미분"><a href="#수치-미분" class="headerlink" title="수치 미분"></a>수치 미분</h3><blockquote>
<p>아주 작은 차분으로 미분하는 것 <br><br>수치 미분에는 오차가 포함된다 <br><br><br></p>
</blockquote>
<p><strong>반올림 오차</strong></p>
<blockquote>
<p>반올림 오차는 소수점 8자리 이하가 생략되어 최종 계산에 오차가 생기게 하는 경우를 말한다</p>
</blockquote>
<br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">np.float32(<span class="number">1e-50</span>)</span><br><span class="line">: <span class="number">0.0</span></span><br></pre></td></tr></table></figure>


<p><strong>차분</strong><br><img src="https://user-images.githubusercontent.com/33630505/68745204-8dcac480-0639-11ea-9f5e-8dd6eb56b002.JPG" alt="차분"></p>
<br>

<p><strong>중앙 차분</strong><br><img src="https://user-images.githubusercontent.com/33630505/68745459-18abbf00-063a-11ea-97df-e8ecf7a8e28d.JPG" alt="중앙 차분"><br><br></p>
<p><strong>수치 미분의 예</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 중앙 차분</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">numerical_diff</span><span class="params">(f, x)</span>:</span></span><br><span class="line">    h = <span class="number">1e-4</span></span><br><span class="line">    <span class="keyword">return</span>(f(x+h) - f(x-h)) / (<span class="number">2</span>*h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># f(x) = 0.01x^2 + 0.1x</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.01</span>*x**<span class="number">2</span> + <span class="number">0.1</span>*x</span><br><span class="line"></span><br><span class="line"><span class="comment"># f(x), f(x)' 그래프 그리기</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func_draw</span><span class="params">(x1, y1,x2,y2)</span>:</span></span><br><span class="line">    plt.xlabel(<span class="string">"x"</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"f(x)"</span>)</span><br><span class="line">    plt.plot(x1,y1, x2,y2, <span class="string">'-r'</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># f(x)' 기울기, y 절편 구하기    </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(x,y,f)</span>:</span></span><br><span class="line">    grad = numerical_diff(f, x)</span><br><span class="line">    b = y - grad*x</span><br><span class="line">    <span class="keyword">return</span> grad, b         </span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">0.0</span>,<span class="number">20.0</span>,<span class="number">0.1</span>)</span><br><span class="line">y = func(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (x=5, y=0.75)</span></span><br><span class="line">function_1 = gen(<span class="number">5</span>, func(<span class="number">5</span>), func)[<span class="number">0</span>]*x + gen(<span class="number">5</span>, func(<span class="number">5</span>), func)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># (x=10, y=2)</span></span><br><span class="line">function_2 = gen(<span class="number">10</span>, func(<span class="number">10</span>), func)[<span class="number">0</span>]*x + gen(<span class="number">10</span>, func(<span class="number">10</span>), func1)[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<br>

<p><strong>func_draw(x, y, x, function_1)</strong><br><img src="https://user-images.githubusercontent.com/33630505/68746541-27937100-063c-11ea-9dba-b837df7a71c4.JPG" alt="func1"></p>
<br>

<p><strong>func_draw(x, y, x, function_2)</strong><br><img src="https://user-images.githubusercontent.com/33630505/68746563-3548f680-063c-11ea-8e37-232475752ad3.JPG" alt="func2"></p>
<br>


<h2 id="학습-알고리즘-구현하기"><a href="#학습-알고리즘-구현하기" class="headerlink" title="학습 알고리즘 구현하기"></a>학습 알고리즘 구현하기</h2><br>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[학습] &#x3D;&gt; 데이터(Feature)의 중요도에 관여하는 가중치와 편향을 훈련 데이터에 적응하도록 조정하는 과정</span><br><span class="line"></span><br><span class="line">[1 단계] &gt; 미니 배치</span><br><span class="line">: 훈련 데이터 중 일부를 무작위로 가져옵니다. 선별한 데이터를 미니배치라 부르며,</span><br><span class="line">  미니배치의 loss function 값을 줄이는 것이 목표입니다.</span><br><span class="line"></span><br><span class="line">[2 단계] &gt; 기울기 산출</span><br><span class="line">: 미니 배치의 loss function 값을 줄이기 위해 각 가중치 매개변수의 기울기를 구합니다.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[3 단계] &gt; 매개변수 갱신</span><br><span class="line">: 가중치 매개변수의 값을 0에 가까워 지도록 갱신합니다.</span><br><span class="line">  그 기울기가 0에 가까워지면 정답 - 예측값이 작아짐을 의미하여 학습이 충분히 되었음을 의미합니다.</span><br><span class="line"></span><br><span class="line">[4 단계] &gt; 1~3 단계를 반복한다</span><br></pre></td></tr></table></figure>

          
            <br>
            
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <section class='widget copyright'>
  <div class='content pure'>
    <blockquote>
      
        <p>
          
            这是文章页脚，可以放置版权说明以及打赏图片。<br>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议
          
        </p>
      
        <p>
          
            
          
        </p>
      
        <p>
          
            本文永久链接是：<a href=http://jungjihyuk.github.io/2019/11/03/deeplearning/>http://jungjihyuk.github.io/2019/11/03/deeplearning/<a>
          
        </p>
      
    </blockquote>
  </div>
</section>

                
              
                
              
                
              
                
              
                
              
            
          
        </div>
        
          <br>
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-02-28T01:47:27+09:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>Feb 28, 2020</p>
    <!-- __('post.updated') + ' ' +  -->
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/python/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>python</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/deep-learning/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i><p>deep learning</p></a></div>


        
      
    </div>
  </section>


        
        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;prev</h6>
                            <h4>
                                <a href="/2019/11/10/java/" rel="prev" title="Java 문법">
                                  
                                      Java 문법
                                  
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/Java/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> Java</a>
                                </h6>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>next&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/2019/10/09/codesignal/" rel="prev" title="CodeSignal Arcade 문제 풀이">
                                    
                                        CodeSignal Arcade 문제 풀이
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/algorithm/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> algorithm</a> <a class="tag" href="/tags/%EC%BD%94%EB%94%A9%EC%97%B0%EC%8A%B5/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> 코딩연습</a> <a class="tag" href="/tags/python/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> python</a> <a class="tag" href="/tags/database/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> database</a> <a class="tag" href="/tags/CodeSignal/"><i class="fas fa-tag fa-fw" aria-hidden="true"></i> CodeSignal</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: '밑바닥부터 시작하는 딥러닝',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          <section class='widget blogger'>
  <div class='content pure'>
    
      <div class='avatar'>
        <img class='avatar' src='/i.JPG'/>
      </div>
    
    
      <div class='text'>
        
        
          <p>블로그 개편중~</p>

        
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:wlgur278@gmail.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/Jungjihyuk"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=63035382"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
          
  <section class='widget toc-wrapper'>
    <header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Shortcuts</div>
  
    <!-- <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div> -->
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AND-Gate-Python으로-구현하기"><span class="toc-text">AND Gate Python으로 구현하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OR-Gate-Python으로-구현하기"><span class="toc-text">OR Gate Python으로 구현하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XOR-Gate-Python으로-구현하기"><span class="toc-text">XOR Gate Python으로 구현하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#활성화-함수"><span class="toc-text">활성화 함수</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#단층-퍼셉트론에서-사용하는-Step-Function"><span class="toc-text">단층 퍼셉트론에서 사용하는 Step Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sigmoid-Function"><span class="toc-text">Sigmoid Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Relu-Function"><span class="toc-text">Relu Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hyperbolic-Tangent-Function"><span class="toc-text">Hyperbolic Tangent Function</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#선형-VS-비선형"><span class="toc-text">선형 VS 비선형</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#입력값-각각을-함수에-대입한-결과의-합과"><span class="toc-text">입력값 각각을 함수에 대입한 결과의 합과</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#입력값의-합을-함수에-대입한-결과가-서로-같다면"><span class="toc-text">입력값의 합을 함수에 대입한 결과가 서로 같다면</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#신경망에서는-활성화함수로-비선형-함수를-사용하는-이유는"><span class="toc-text">신경망에서는 활성화함수로 비선형 함수를 사용하는 이유는?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#행렬-곱연산-VS-dot-VS-matmul"><span class="toc-text">행렬 곱연산 VS dot VS matmul</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#내적-inner-product"><span class="toc-text">내적(inner product)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#다층-신경망-구현하기-3층-신경망-또는-2층-신경망"><span class="toc-text">다층 신경망 구현하기(3층 신경망 또는 2층 신경망)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#version-1"><span class="toc-text">version 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-2"><span class="toc-text">version 2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#출력층-설계하기"><span class="toc-text">출력층 설계하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#기계학습은-학습과-추론-두-단계를-거친다-backward-propagation-amp-forward-propagation"><span class="toc-text">기계학습은 학습과 추론 두 단계를 거친다(backward propagation &amp; forward propagation)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#사람-VS-기계학습-VS-딥러닝"><span class="toc-text">사람 VS 기계학습 VS 딥러닝</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#분류"><span class="toc-text">분류</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MNIST-데이터-셋으로-추론-처리-구현하기-분류"><span class="toc-text">MNIST 데이터 셋으로 추론 처리 구현하기(분류)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#회귀"><span class="toc-text">회귀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#배치-Batch"><span class="toc-text">배치 (Batch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Batch-VS-Mini-Batch-VS-Stochastic-Gradient-Descent"><span class="toc-text">Batch VS Mini Batch VS Stochastic Gradient Descent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lose-Function-Cost-Function"><span class="toc-text">Lose Function(Cost Function)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mean-Squared-Error-평균-제곱-오차"><span class="toc-text">Mean Squared Error(평균 제곱 오차)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cross-Entropy-Error-교차-엔트로피-오차"><span class="toc-text">Cross Entropy Error(교차 엔트로피 오차)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#해석적-미분-VS-수치-미분"><span class="toc-text">해석적 미분 VS 수치 미분</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#해석적-미분"><span class="toc-text">해석적 미분</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#수치-미분"><span class="toc-text">수치 미분</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#학습-알고리즘-구현하기"><span class="toc-text">학습 알고리즘 구현하기</span></a></li></ol>
    </div>
  </section>


        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
          
  <section class='widget category'>
    <header class='pure'>
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;category</div>
  
    <a class="rightBtn"
    
      rel="external nofollow noopener noreferrer"
    
    
      target="_self"
    
    href="/categories/"
    title="categories/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/AI/" href="/categories/AI/"><div class='name'>AI</div><div class='badge'>(6)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/AI/Data-Analysis/" href="/categories/AI/Data-Analysis/"><div class='name'>Data Analysis</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/AI/Deep-Learning/" href="/categories/AI/Deep-Learning/"><div class='name'>Deep Learning</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/AI/Machine-Learning/" href="/categories/AI/Machine-Learning/"><div class='name'>Machine Learning</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/AI/Natural-Language-Processing/" href="/categories/AI/Natural-Language-Processing/"><div class='name'>Natural Language Processing</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Algorithm/" href="/categories/Algorithm/"><div class='name'>Algorithm</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Data-Structure/" href="/categories/Data-Structure/"><div class='name'>Data Structure</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/English/" href="/categories/English/"><div class='name'>English</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Git/" href="/categories/Git/"><div class='name'>Git</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/IT-Terms/" href="/categories/IT-Terms/"><div class='name'>IT Terms</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/JSP-Servlet/" href="/categories/JSP-Servlet/"><div class='name'>JSP & Servlet</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Language/" href="/categories/Language/"><div class='name'>Language</div><div class='badge'>(7)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Language/Java/" href="/categories/Language/Java/"><div class='name'>Java</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Language/Markup-Language/" href="/categories/Language/Markup-Language/"><div class='name'>Markup Language</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Language/Python/" href="/categories/Language/Python/"><div class='name'>Python</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Web/" href="/categories/Web/"><div class='name'>Web</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Web/Bootstrap4/" href="/categories/Web/Bootstrap4/"><div class='name'>Bootstrap4</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Web/Django/" href="/categories/Web/Django/"><div class='name'>Django</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Web/Flask/" href="/categories/Web/Flask/"><div class='name'>Flask</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Web/Object-Model/" href="/categories/Web/Object-Model/"><div class='name'>Object Model</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Web/Objectoriented/" href="/categories/Web/Objectoriented/"><div class='name'>Objectoriented</div><div class='badge'>(1)</div></a></li>
        
      </ul>
    </div>
  </section>


        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
          
  <section class='widget tagcloud'>
    <header class='pure'>
  <div><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Keywords</div>
  
    <a class="rightBtn"
    
      rel="external nofollow noopener noreferrer"
    
    
      target="_self"
    
    href="/tags/"
    title="tags/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      <a href="/tags/AI/" style="font-size: 14px; color: #999">AI</a> <a href="/tags/CodeSignal/" style="font-size: 14px; color: #999">CodeSignal</a> <a href="/tags/CodeSignal2/" style="font-size: 14px; color: #999">CodeSignal2</a> <a href="/tags/Data-Analysis/" style="font-size: 14px; color: #999">Data Analysis</a> <a href="/tags/Deep-Learning/" style="font-size: 17.33px; color: #828282">Deep Learning</a> <a href="/tags/Django/" style="font-size: 14px; color: #999">Django</a> <a href="/tags/EDA/" style="font-size: 14px; color: #999">EDA</a> <a href="/tags/Flask/" style="font-size: 14px; color: #999">Flask</a> <a href="/tags/FrontEnd/" style="font-size: 14px; color: #999">FrontEnd</a> <a href="/tags/Git/" style="font-size: 14px; color: #999">Git</a> <a href="/tags/Git-Flow/" style="font-size: 14px; color: #999">Git-Flow</a> <a href="/tags/Github/" style="font-size: 14px; color: #999">Github</a> <a href="/tags/Gitlab/" style="font-size: 14px; color: #999">Gitlab</a> <a href="/tags/IT/" style="font-size: 14px; color: #999">IT</a> <a href="/tags/Java/" style="font-size: 14px; color: #999">Java</a> <a href="/tags/Jsp/" style="font-size: 14px; color: #999">Jsp</a> <a href="/tags/Lecture/" style="font-size: 14px; color: #999">Lecture</a> <a href="/tags/Machine-Learning/" style="font-size: 17.33px; color: #828282">Machine Learning</a> <a href="/tags/NLP/" style="font-size: 14px; color: #999">NLP</a> <a href="/tags/Programming/" style="font-size: 14px; color: #999">Programming</a> <a href="/tags/Python/" style="font-size: 17.33px; color: #828282">Python</a> <a href="/tags/Servlet/" style="font-size: 14px; color: #999">Servlet</a> <a href="/tags/Web/" style="font-size: 14px; color: #999">Web</a> <a href="/tags/algorithm/" style="font-size: 20.67px; color: #6c6c6c">algorithm</a> <a href="/tags/api/" style="font-size: 14px; color: #999">api</a> <a href="/tags/bom/" style="font-size: 14px; color: #999">bom</a> <a href="/tags/bootstrap/" style="font-size: 14px; color: #999">bootstrap</a> <a href="/tags/clean-code/" style="font-size: 14px; color: #999">clean code</a> <a href="/tags/crawling/" style="font-size: 14px; color: #999">crawling</a> <a href="/tags/css/" style="font-size: 14px; color: #999">css</a> <a href="/tags/data-mining/" style="font-size: 14px; color: #999">data mining</a> <a href="/tags/database/" style="font-size: 17.33px; color: #828282">database</a> <a href="/tags/deep-learning/" style="font-size: 17.33px; color: #828282">deep learning</a> <a href="/tags/deque/" style="font-size: 14px; color: #999">deque</a> <a href="/tags/dom/" style="font-size: 14px; color: #999">dom</a> <a href="/tags/generator/" style="font-size: 14px; color: #999">generator</a> <a href="/tags/git/" style="font-size: 14px; color: #999">git</a> <a href="/tags/helper-function/" style="font-size: 14px; color: #999">helper function</a> <a href="/tags/iris/" style="font-size: 14px; color: #999">iris</a> <a href="/tags/javascript/" style="font-size: 14px; color: #999">javascript</a> <a href="/tags/js/" style="font-size: 14px; color: #999">js</a> <a href="/tags/json/" style="font-size: 14px; color: #999">json</a> <a href="/tags/neural-network/" style="font-size: 14px; color: #999">neural network</a> <a href="/tags/object/" style="font-size: 14px; color: #999">object</a> <a href="/tags/object-model/" style="font-size: 14px; color: #999">object model</a> <a href="/tags/page-rank/" style="font-size: 14px; color: #999">page rank</a> <a href="/tags/python/" style="font-size: 24px; color: #555">python</a> <a href="/tags/queue/" style="font-size: 14px; color: #999">queue</a> <a href="/tags/scraping/" style="font-size: 14px; color: #999">scraping</a> <a href="/tags/send/" style="font-size: 14px; color: #999">send</a> <a href="/tags/stack/" style="font-size: 14px; color: #999">stack</a> <a href="/tags/tensorflow/" style="font-size: 14px; color: #999">tensorflow</a> <a href="/tags/xml/" style="font-size: 14px; color: #999">xml</a> <a href="/tags/yield/" style="font-size: 14px; color: #999">yield</a> <a href="/tags/%EB%AA%85%EB%A0%B9%EC%96%B4/" style="font-size: 14px; color: #999">명령어</a> <a href="/tags/%EB%AC%B8%EB%B2%95/" style="font-size: 14px; color: #999">문법</a> <a href="/tags/%EB%B0%B1%EC%A4%80/" style="font-size: 14px; color: #999">백준</a> <a href="/tags/%EC%82%B0%ED%83%80-%ED%86%A0%EC%9D%B5/" style="font-size: 14px; color: #999">산타 토익</a> <a href="/tags/%EC%84%A4%EA%B3%84/" style="font-size: 14px; color: #999">설계</a> <a href="/tags/%EC%8B%9C%EC%9B%90%EC%8A%A4%EC%BF%A8/" style="font-size: 14px; color: #999">시원스쿨</a> <a href="/tags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/" style="font-size: 14px; color: #999">알고리즘</a> <a href="/tags/%EC%98%81%EC%96%B4/" style="font-size: 17.33px; color: #828282">영어</a> <a href="/tags/%EC%9A%A9%EC%96%B4/" style="font-size: 14px; color: #999">용어</a> <a href="/tags/%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0/" style="font-size: 14px; color: #999">자료구조</a> <a href="/tags/%EC%9E%90%EC%97%B0%EC%96%B4-%EC%B2%98%EB%A6%AC/" style="font-size: 14px; color: #999">자연어 처리</a> <a href="/tags/%EC%A0%95%EB%A6%AC/" style="font-size: 20.67px; color: #6c6c6c">정리</a> <a href="/tags/%EC%BD%94%EB%94%A9%EC%97%B0%EC%8A%B5/" style="font-size: 17.33px; color: #828282">코딩연습</a> <a href="/tags/%ED%86%A0%EC%9D%B5/" style="font-size: 14px; color: #999">토익</a> <a href="/tags/%ED%95%9C%EB%88%88%EC%97%90-%EB%B3%B4%EA%B8%B0/" style="font-size: 17.33px; color: #828282">한눈에 보기</a> <a href="/tags/%ED%95%9C%EB%88%88%EC%97%90-%EC%A0%95%EB%A6%AC/" style="font-size: 14px; color: #999">한눈에 정리</a> <a href="/tags/%ED%98%91%EC%97%85/" style="font-size: 14px; color: #999">협업</a> <a href="/tags/%ED%9A%8C%ED%99%94/" style="font-size: 14px; color: #999">회화</a>
    </div>
  </section>


        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
        
      
        
          
  <section class='widget music'>
    <header class='pure'>
  <div><i class="fas fa-compact-disc fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Music</div>
  
    <a class="rightBtn"
    
      rel="external nofollow noopener noreferrer"
    
    
      target="_blank"
    
    href="https://music.163.com/#/user/home?id=63035382"
    title="https://music.163.com/#/user/home?id=63035382">
    <i class="far fa-heart fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      

  
    <meting-js
      theme='#1BCDFC'
      autoplay='true'
      volume='0.7'
      loop='all'
      order='list'
      server='netease'
      type='playlist'
      id='3175833810'>
    </meting-js>
  


    </div>
  </section>


        
      
        
      
        
      
        
      
        
      
        
      
    
  
</aside>

<footer class="clearfix">
  
    <div class="social-wrapper">
      
        
          <a href="/atom.xml"
            class="social fas fa-rss flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:wlgur278@gmail.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/Jungjihyuk"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=63035382"
            class="social fas fa-headphones-alt flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <!-- <div><- markdown(__('footer.license')) </div> -->
  <div>
    <!-- <- __('footer.use')  -->
    <!-- a href = "<- theme.info.docs " -->
    <span>Copyright. </span>
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material-X</a>
    <!-- <- theme.info.name    -->
    <!-- <- __('footer.theme')  -->
    <br>
    
      <span id="busuanzi_container_site_pv">
        Total <span id="busuanzi_value_site_pv"></span> views
      </span>
      <span id="busuanzi_container_site_uv">
        You got <span id="busuanzi_value_site_uv"></span> visitors
      </span>
    
    . 
  </div>
  
</footer>
<script>setLoadingBarProgress(80);</script>
<script async src = "//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script >


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>

<script async src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>

  <script async src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>
  <script async src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@20.2/js/backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('') {
          $('').backstretch(
          ["unsplash.jpg", "jonathan.jpg", "flower.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["unsplash.jpg", "jonathan.jpg", "flower.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  











  
<script src="/js/app.js"></script>



  
<script src="/js/search.js"></script>



  
    
<script src="/js/commentTyping.js"></script>

  





<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "Copied";
  let COPY_FAILURE = "Copy failed";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>Copy</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
